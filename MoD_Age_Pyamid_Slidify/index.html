<!DOCTYPE html>
<html>
<head>
  <title>UK Armed Forces Age Statistics</title>
  <meta charset="utf-8">
  <meta name="description" content="UK Armed Forces Age Statistics">
  <meta name="author" content="Ewan Keith">
  <meta name="generator" content="slidify" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta http-equiv="X-UA-Compatible" content="chrome=1">
  <link rel="stylesheet" href="libraries/frameworks/io2012/css/default.css" media="all" >
  <link rel="stylesheet" href="libraries/frameworks/io2012/css/phone.css" 
    media="only screen and (max-device-width: 480px)" >
  <link rel="stylesheet" href="libraries/frameworks/io2012/css/slidify.css" >
  <link rel="stylesheet" href="libraries/highlighters/highlight.js/css/tomorrow.css" />
  <base target="_blank"> <!-- This amazingness opens all links in a new tab. -->  <link rel=stylesheet href="libraries/widgets/nvd3/css/nv.d3.css"></link>
<link rel=stylesheet href="libraries/widgets/nvd3/css/rNVD3.css"></link>

  
  <!-- Grab CDN jQuery, fall back to local if offline -->
  <script src="http://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.7.min.js"></script>
  <script>window.jQuery || document.write('<script src="libraries/widgets/quiz/js/jquery.js"><\/script>')</script> 
  <script data-main="libraries/frameworks/io2012/js/slides" 
    src="libraries/frameworks/io2012/js/require-1.0.8.min.js">
  </script>
  
  <script src="libraries/widgets/nvd3/js/jquery-1.8.2.min.js"></script>
<script src="libraries/widgets/nvd3/js/d3.v3.min.js"></script>
<script src="libraries/widgets/nvd3/js/nv.d3.min-new.js"></script>
<script src="libraries/widgets/nvd3/js/fisheye.js"></script>


</head>
<body style="opacity: 0">
  <slides class="layout-widescreen">
    
    <!-- LOGO SLIDE -->
        <slide class="title-slide segue nobackground">
  <hgroup class="auto-fadein">
    <h1>UK Armed Forces Age Statistics</h1>
    <h2>Using Shiny and Slidify to display data interactively</h2>
    <p>Ewan Keith<br/></p>
  </hgroup>
  <article></article>  
</slide>
    

    <!-- SLIDES -->
    <slide class="" id="slide-1" style="background:;">
  <hgroup>
    <h2>Age of the UK Armed Forces</h2>
  </hgroup>
  <article data-timings="">
    <p>The British Ministry of Defence (MoD) Publishes Annual Statistics 
on the age  of it&#39;s military personnel.</p>

<p>These figures are reported in the MoD&#39;s 
<em>UK armed forces annual personnel report</em>. </p>

<p>Recent reports can be found <a href="https://www.gov.uk/government/collections/uk-armed-forces-annual-manning-statistics-index">here</a></p>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-2" style="background:;">
  <hgroup>
    <h2>Available Breakdown</h2>
  </hgroup>
  <article data-timings="">
    <p>The published figures provide age data broken down by:</p>

<ul>
<li>Rank Type (Officer or Other Rank)</li>
<li>Gender</li>
<li>Service (Naval Services, Army or RAF)</li>
</ul>

<p>This Shiny App did not focus on differences between services, 
although could easily be extended in order to do so. </p>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-3" style="background:;">
  <hgroup>
    <h2>Why use Shiny to display this data?</h2>
  </hgroup>
  <article data-timings="">
    <p>Shiny allows for the interactive display of both absolute 
numbers and relative percentage within gender depending 
on user input.</p>

<p>This helpfully illustrates both the age distributions within 
each rank <em>and</em> the large differences in total numbers between
men and woman at all ranks.</p>

<p>The age pyramids were produced using the NVD3 Javascript
library called via rCharts. Formatting and code were heavily 
borrowed from <a href="http://walkerke.github.io/2014/06/rcharts-pyramids/">Kyle Walker&#39;s blog post on age pyramids</a>.</p>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-4" style="background:;">
  <hgroup>
    <h2>Other options</h2>
  </hgroup>
  <article data-timings="">
    <p>Another option for display would have been to show Officers and Other ranks as the two sides to a single pyramid. See an example of this beow.</p>

<div id = 'chart168864052e33' class = 'rChart nvd3'></div>

<script type='text/javascript'>
 $(document).ready(function(){
      drawchart168864052e33()
    });
    function drawchart168864052e33(){  
      var opts = {
 "dom": "chart168864052e33",
"width":    800,
"height":    400,
"x": "Age.group",
"y": "numbers",
"group": "rank.type",
"type": "multiBarHorizontalChart",
"title": "Age of Male Personnel by Rank Type",
"id": "chart168864052e33" 
},
        data = [
 {
 "Age.group": "Under 18",
"numbers":              0,
"gender": "male",
"percent":              0,
"rank.type": "officer" 
},
{
 "Age.group": "18-19",
"numbers":             30,
"gender": "male",
"percent":    0.001398314,
"rank.type": "officer" 
},
{
 "Age.group": "20-24",
"numbers":           1470,
"gender": "male",
"percent":    0.060621016,
"rank.type": "officer" 
},
{
 "Age.group": "25-29",
"numbers":           4300,
"gender": "male",
"percent":    0.177010076,
"rank.type": "officer" 
},
{
 "Age.group": "30-34",
"numbers":           4130,
"gender": "male",
"percent":    0.169689492,
"rank.type": "officer" 
},
{
 "Age.group": "35-39",
"numbers":           3650,
"gender": "male",
"percent":    0.149948591,
"rank.type": "officer" 
},
{
 "Age.group": "40-44",
"numbers":           4090,
"gender": "male",
"percent":    0.168167798,
"rank.type": "officer" 
},
{
 "Age.group": "45-49",
"numbers":           3980,
"gender": "male",
"percent":    0.163890603,
"rank.type": "officer" 
},
{
 "Age.group": "50 and over",
"numbers":           2660,
"gender": "male",
"percent":    0.109274111,
"rank.type": "officer" 
},
{
 "Age.group": "Under 18",
"numbers":          -1610,
"gender": "male",
"percent":    0.013509328,
"rank.type": "other.rank" 
},
{
 "Age.group": "18-19",
"numbers":          -5790,
"gender": "male",
"percent":    0.048454463,
"rank.type": "other.rank" 
},
{
 "Age.group": "20-24",
"numbers":         -29700,
"gender": "male",
"percent":    0.248574992,
"rank.type": "other.rank" 
},
{
 "Age.group": "25-29",
"numbers":         -29910,
"gender": "male",
"percent":    0.250382932,
"rank.type": "other.rank" 
},
{
 "Age.group": "30-34",
"numbers":         -22040,
"gender": "male",
"percent":    0.184443347,
"rank.type": "other.rank" 
},
{
 "Age.group": "35-39",
"numbers":         -15080,
"gender": "male",
"percent":    0.126204247,
"rank.type": "other.rank" 
},
{
 "Age.group": "40-44",
"numbers":          -9580,
"gender": "male",
"percent":    0.080218962,
"rank.type": "other.rank" 
},
{
 "Age.group": "45-49",
"numbers":          -4010,
"gender": "male",
"percent":    0.033564069,
"rank.type": "other.rank" 
},
{
 "Age.group": "50 and over",
"numbers":          -1750,
"gender": "male",
"percent":    0.014647661,
"rank.type": "other.rank" 
} 
]
  
      var data = d3.nest()
        .key(function(d){
          return opts.group === undefined ? 'main' : d[opts.group]
        })
        .entries(data)
      
      nv.addGraph(function() {
        var chart = nv.models[opts.type]()
          .x(function(d) { return d[opts.x] })
          .y(function(d) { return d[opts.y] })
          .width(opts.width)
          .height(opts.height)
         
        chart
  .xDomain([ "50 and over", "45-49", "40-44", "35-39", "30-34", "25-29", "20-24", "18-19", "Under 18" ])
  .stacked(true)
  .tooltipContent( function(key, x, y, e){
               var format = d3.format('0,000');
               return '<h3>' + key + ', age ' + x + '</h3>' + 
               '<p>' + 'Population: ' + y + '</p>'
    } )
  .margin({
 "left":     70,
"right":     40 
})
  .color([ "darkred", "silver" ])
  .showControls(false)
          
        

        
        
        chart.yAxis
  .axisLabel("Population")
  .tickFormat( function(d) {
               var format = d3.format('0,000');
               return format(Math.abs(d))
  } )
      
       d3.select("#" + opts.id)
        .append('svg')
        .datum(data)
        .transition().duration(500)
        .call(chart);

       nv.utils.windowResize(chart.update);
       return chart;
      });
      
      //add our title with html
      //might be better with svg
      d3.select("#" + opts.id).insert("h3","svg")
        .text(opts.title);
        //if desired, could change styling with css or with d3
        //some examples here http://tympanus.net/codrops/2012/11/02/heading-set-styling-with-css/
        //will use example
        //.style("float","right");
        //.style("text-shadow", "0 -1px 1px rgba(0,0,0,0.4)")
        //.style("font-size","22px")
        //.style("line-height", "40px")
        //.style("color", "#355681")
        //.style("ext-transform", "uppercase")
        //.style("border-bottom", "1px solid rgba(53,86,129, 0.3)");
    };
</script>

  </article>
  <!-- Presenter Notes -->
</slide>

    <slide class="backdrop"></slide>
  </slides>
  <div class="pagination pagination-small" id='io2012-ptoc' style="display:none;">
    <ul>
      <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=1 title='Age of the UK Armed Forces'>
         1
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=2 title='Available Breakdown'>
         2
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=3 title='Why use Shiny to display this data?'>
         3
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=4 title='Other options'>
         4
      </a>
    </li>
  </ul>
  </div>  <!--[if IE]>
    <script 
      src="http://ajax.googleapis.com/ajax/libs/chrome-frame/1/CFInstall.min.js">  
    </script>
    <script>CFInstall.check({mode: 'overlay'});</script>
  <![endif]-->
</body>
  <!-- Load Javascripts for Widgets -->
  
  <!-- LOAD HIGHLIGHTER JS FILES -->
  <script src="libraries/highlighters/highlight.js/highlight.pack.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>
  <!-- DONE LOADING HIGHLIGHTER JS FILES -->
   
  </html>